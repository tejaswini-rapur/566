//Experiment-6
//2311CS020566-DBMS ASSIGNMENT
//creating employee table
CREATE TABLE Employee (
    EMPNO VARCHAR(10) PRIMARY KEY,
    EMP_NAME VARCHAR(50),
    DEPT VARCHAR(50),
    SALARY INT,
    DOJ DATE,
    BRANCH VARCHAR(50)
);

//Inserting Sample Data
INSERT INTO Employee (EMPNO, EMP_NAME, DEPT, SALARY, DOJ, BRANCH) VALUES
('E101', 'Amit', 'Production', 45000, '2000-03-12', 'Bangalore'),
('E102', 'Amit', 'HR', 70000, '2002-07-03', 'Bangalore'),
('E103', 'Sunita', 'Management', 120000, '2001-01-11', 'Mysore'),
('E105', 'Sunita', 'IT', 67000, '2001-08-01', 'Mysore'),
('E106', 'Mahesh', 'Civil', 145000, '2003-09-20', 'Mumbai');

//Queries
(a)
i)SELECT * FROM Employee;
ii)SELECT EMPNO, SALARY FROM Employee;
iii)SELECT AVG(SALARY) FROM Employee;
iv)SELECT COUNT(*) FROM Employee;
v)SELECT COUNT(DISTINCT EMP_NAME) FROM Employee;
vi)SELECT EMP_NAME, SUM(SALARY), COUNT(*) FROM Employee GROUP BY EMP_NAME;
vii)SELECT EMP_NAME, SUM(SALARY) FROM Employee GROUP BY EMP_NAME HAVING SUM(SALARY) > 120000;
viii)SELECT EMP_NAME FROM Employee ORDER BY EMP_NAME DESC;
ix)SELECT * FROM Employee WHERE EMP_NAME = 'Amit' AND SALARY > 50000;

(b)
i)
SELECT CURRENT_DATE;
SELECT EXTRACT(YEAR FROM CURRENT_DATE);
SELECT EXTRACT(DAY FROM CURRENT_DATE);
SELECT EXTRACT(MONTH FROM CURRENT_DATE);
ii)
SELECT ASCII('A');
SELECT UPPER('mallareddy university');
SELECT LOWER('WELCOME TO DBMSLAB');
SELECT REPLACE('HELLO', 'H', 'K');
SELECT TRIM('A' FROM 'ANACONDA');
(c)
//Creating Student and Fee Tables
CREATE TABLE Student (
    admission_no INT PRIMARY KEY,
    first_name VARCHAR(45),
    last_name VARCHAR(45),
    age INT,
    city VARCHAR(25)
);

CREATE TABLE Fee (
    admission_no INT,
    course VARCHAR(45),
    amount_paid INT,
    FOREIGN KEY (admission_no) REFERENCES Student(admission_no)
);

//Insert Data
INSERT INTO Student (admission_no, first_name, last_name, age, city) VALUES
(3354, 'Luisa', 'Evans', 13, 'Texas'),
(2135, 'Paul', 'Ward', 15, 'Alaska'),
(4321, 'Peter', 'Bennett', 14, 'California');

INSERT INTO Fee (admission_no, course, amount_paid) VALUES
(3354, 'Java', 20000),
(4321, 'Python', 18000);

-- Join Queries
SELECT Student.admission_no, Student.first_name, Fee.course, Fee.amount_paid
FROM Student INNER JOIN Fee ON Student.admission_no = Fee.admission_no;

SELECT Student.admission_no, Student.first_name, Fee.course, Fee.amount_paid
FROM Student LEFT JOIN Fee ON Student.admission_no = Fee.admission_no;

SELECT Student.admission_no, Student.first_name, Fee.course, Fee.amount_paid
FROM Student RIGHT JOIN Fee ON Student.admission_no = Fee.admission_no;

SELECT Student.admission_no, Student.first_name, Fee.course, Fee.amount_paid
FROM Student FULL OUTER JOIN Fee ON Student.admission_no = Fee.admission_no;

Exercise:
//Employee Table
CREATE TABLE EMPLOYEE (
    Emp_no INT PRIMARY KEY,
    E_name VARCHAR(50),
    E_address VARCHAR(100),
    E_ph_no VARCHAR(15),
    Dept_no INT,
    Dept_name VARCHAR(50),
    Job_id INT,
    Designation VARCHAR(50),
    Salary INT,
    DOJ DATE
);

-- Queries on EMPLOYEE Table
1)SELECT Emp_no, E_name, Salary FROM EMPLOYEE WHERE Designation = 'MANAGER';
2)SELECT * FROM EMPLOYEE WHERE Salary > (SELECT MAX(Salary) FROM EMPLOYEE WHERE Designation = 'IT PROFESSIONAL');
3)SELECT * FROM EMPLOYEE WHERE YEAR(DOJ) > 1981 ORDER BY Designation ASC;
4)SELECT Emp_no, E_name, Salary, DATEDIFF(CURDATE(), DOJ) / 365 AS Experience_Years, Salary / 365 AS Daily_Salary FROM EMPLOYEE;
5)SELECT * FROM EMPLOYEE WHERE Designation IN ('CLERK', 'ANALYST');
